#include<bits/stdc++.h>
using namespace std;

using number = unsigned long long;

#define faster() ios_base::sync_with_stdio(false); cin.tie(nullptr); cout.tie(nullptr);

int main(void)
{
    faster();

    // m, n, and vector<number> size got by running helpingsolution.cpp
    number n = 1000, m = 4;
    vector<number> size = {2 ,4 ,2 ,2 ,2 ,3 ,4 ,4 ,4 ,2 ,4 ,4 ,2 ,2 ,4 ,3 ,4 ,3 ,2 ,3 ,3 ,3 ,3 ,4 ,2 ,3 ,3 ,3 ,2 ,4 ,3 ,4 ,4 ,4 ,2 ,4 ,3 ,3 ,3 ,2 ,3 ,3 ,3 ,3 ,3 ,4 ,2 ,3 ,2 ,3 ,2 ,3 ,4 ,4 ,3 ,2 ,2 ,2 ,3 ,2 ,2 ,3 ,3 ,3 ,2 ,3 ,2 ,4 ,3 ,2 ,4 ,3 ,4 ,2 ,3 ,2 ,4 ,3 ,2 ,2 ,2 ,3 ,3 ,3 ,2 ,3 ,3 ,3 ,3 ,3 ,2 ,2 ,3 ,3 ,2 ,4 ,4 ,4 ,4 ,3 ,2 ,3 ,3 ,2 ,2 ,3 ,2 ,3 ,2 ,3 ,3 ,3 ,4 ,3 ,2 ,3 ,4 ,2 ,3 ,2 ,3 ,3 ,3 ,2 ,3 ,3 ,3 ,2 ,2 ,2 ,2 ,2 ,2 ,3 ,3 ,3 ,2 ,2 ,4 ,4 ,3 ,3 ,2 ,2 ,3 ,3 ,3 ,3 ,3 ,3 ,2 ,2 ,4 ,3 ,4 ,2 ,2 ,2 ,2 ,2 ,4 ,2 ,4 ,3 ,4 ,3 ,3 ,3 ,2 ,4 ,3 ,2 ,3 ,2 ,4 ,2 ,3 ,2 ,4 ,2 ,3 ,3 ,3 ,4 ,4 ,4 ,2 ,2 ,3 ,3 ,2 ,2 ,3 ,2 ,3 ,2 ,2 ,2 ,2 ,3 ,4 ,2 ,3 ,3 ,3 ,3 ,2 ,2 ,2 ,2 ,3 ,2 ,2 ,2 ,3 ,4 ,2 ,2 ,4 ,3 ,3 ,2 ,3 ,3 ,4 ,2 ,2 ,2 ,2 ,3 ,2 ,2 ,3 ,3 ,3 ,3 ,2 ,3 ,2 ,2 ,3 ,3 ,3 ,3 ,3 ,2 ,2 ,3 ,3 ,3 ,2 ,2 ,4 ,3 ,2 ,4 ,3 ,3 ,3 ,3 ,2 ,2 ,2 ,3 ,2 ,3 ,3 ,2 ,2 ,3 ,3 ,2 ,4 ,4 ,2 ,3 ,2 ,3 ,4 ,3 ,3 ,2 ,2 ,3 ,3 ,3 ,3 ,2 ,3 ,2 ,2 ,4 ,2 ,2 ,3 ,3 ,2 ,3 ,3 ,3 ,3 ,3 ,4 ,3 ,3 ,3 ,3 ,3 ,3 ,2 ,3 ,2 ,2 ,3 ,2 ,3 ,3 ,2 ,3 ,2 ,3 ,2 ,2 ,4 ,3 ,3 ,3 ,4 ,2 ,4 ,3 ,3 ,3 ,2 ,3 ,3 ,4 ,4 ,2 ,3 ,2 ,3 ,2 ,3 ,2 ,3 ,2 ,2 ,2 ,3 ,3 ,3 ,3 ,3 ,3 ,4 ,4 ,3 ,2 ,4 ,3 ,2 ,3 ,3 ,4 ,2 ,2 ,3 ,2 ,3 ,4 ,2 ,2 ,3 ,3 ,3 ,2 ,2 ,2 ,3 ,3 ,2 ,3 ,2 ,3 ,2 ,2 ,3 ,2 ,2 ,3 ,2 ,4 ,4 ,3 ,3 ,4 ,3 ,2 ,2 ,3 ,3 ,2 ,2 ,3 ,3 ,2 ,2 ,4 ,2 ,2 ,2 ,2 ,2 ,2 ,3 ,2 ,2 ,2 ,3 ,2 ,2 ,3 ,2 ,2 ,4 ,3 ,3 ,4 ,2 ,2 ,3 ,4 ,3 ,2 ,3 ,3 ,2 ,2 ,2 ,3 ,4 ,3 ,2 ,3 ,3 ,2 ,4 ,2 ,2 ,2 ,4 ,3 ,3 ,3 ,3 ,2 ,3 ,2 ,2 ,3 ,2 ,3 ,3 ,3 ,3 ,2 ,3 ,3 ,4 ,2 ,2 ,3 ,3 ,3 ,4 ,4 ,2 ,4 ,2 ,4 ,2 ,3 ,2 ,2 ,4 ,2 ,2 ,3 ,2 ,3 ,2 ,2 ,3 ,4 ,2 ,4 ,2 ,3 ,4 ,3 ,3 ,2 ,3 ,4 ,3 ,4 ,3 ,4 ,2 ,4 ,4 ,3 ,3 ,3 ,2 ,2 ,3 ,2 ,2 ,2 ,3 ,3 ,2 ,2 ,3 ,4 ,2 ,3 ,2 ,2 ,4 ,3 ,3 ,4 ,2 ,2 ,2 ,3 ,2 ,3 ,2 ,2 ,3 ,3 ,2 ,3 ,2 ,3 ,3 ,4 ,3 ,3 ,2 ,3 ,4 ,3 ,2 ,2 ,3 ,2 ,2 ,3 ,3 ,3 ,2 ,2 ,4 ,3 ,4 ,3 ,3 ,2 ,3 ,2 ,2 ,3 ,3 ,4 ,3 ,4 ,3 ,2 ,3 ,2 ,2 ,3 ,2 ,2 ,3 ,3 ,2 ,2 ,3 ,4 ,3 ,4 ,3 ,2 ,3 ,3 ,2 ,2 ,2 ,4 ,2 ,4 ,2 ,3 ,3 ,3 ,3 ,4 ,2 ,2 ,2 ,2 ,3 ,3 ,3 ,2 ,2 ,3 ,3 ,3 ,3 ,3 ,3 ,4 ,2 ,2 ,2 ,3 ,3 ,2 ,2 ,2 ,4 ,3 ,3 ,4 ,3 ,3 ,2 ,3 ,4 ,2 ,4 ,2 ,3 ,2 ,3 ,3 ,3 ,3 ,2 ,3 ,3 ,3 ,3 ,3 ,2 ,2 ,2 ,3 ,3 ,3 ,3 ,4 ,3 ,4 ,4 ,3 ,2 ,2 ,2 ,3 ,3 ,3 ,2 ,3 ,3 ,4 ,2 ,2 ,3 ,3 ,2 ,3 ,3 ,2 ,4 ,4 ,3 ,4 ,2 ,2 ,4 ,2 ,2 ,2 ,2 ,2 ,3 ,2 ,3 ,2 ,3 ,3 ,4 ,2 ,2 ,2 ,3 ,3 ,3 ,3 ,3 ,3 ,4 ,2 ,2 ,3 ,3 ,4 ,2 ,2 ,2 ,2 ,3 ,3 ,4 ,2 ,3 ,2 ,2 ,3 ,2 ,2 ,4 ,2 ,3 ,2 ,4 ,3 ,2 ,3 ,2 ,2 ,3 ,3 ,2 ,3 ,2 ,3 ,3 ,4 ,3 ,3 ,3 ,2 ,3 ,4 ,2 ,3 ,3 ,2 ,3 ,3 ,2 ,3 ,2 ,2 ,3 ,2 ,3 ,2 ,4 ,3 ,3 ,2 ,3 ,3 ,4 ,4 ,2 ,2 ,2 ,3 ,4 ,2 ,2 ,4 ,2 ,3 ,2 ,3 ,3 ,2 ,2 ,3 ,3 ,3 ,3 ,3 ,2 ,2 ,3 ,2 ,3 ,2 ,2 ,2 ,3 ,2 ,2 ,3 ,3 ,3 ,3 ,3 ,2 ,3 ,2 ,3 ,3 ,2 ,3 ,2 ,2 ,3 ,2 ,2 ,3 ,3 ,3 ,3 ,4 ,3 ,2 ,2 ,2 ,2 ,3 ,3 ,3 ,3 ,3 ,2 ,2 ,3 ,2 ,3 ,3 ,2 ,3 ,4 ,3 ,2 ,2 ,3 ,4 ,4 ,4 ,4 ,4 ,3 ,3 ,3 ,3 ,4 ,4 ,3 ,3 ,4 ,2 ,2 ,3 ,4 ,3 ,3 ,2 ,3 ,4 ,2 ,3 ,3 ,3 ,2 ,3 ,2 ,2 ,3 ,2 ,3 ,3 ,4 ,2 ,3 ,2 ,4 ,2 ,3 ,2 ,3 ,3 ,3 ,4 ,2 ,3 ,2 ,4 ,2 ,2 ,2 ,3 ,3 ,3 ,2 ,2 ,2 ,3 ,3 ,2 ,3 ,3 ,2 ,3 ,3 ,2 ,2 ,3 ,3 ,3 ,3 ,4 ,3 ,2 ,2 ,3 ,2 ,4 ,2 ,2 ,2 ,3 ,3 ,4 ,2 ,4 ,3 ,2 ,2 ,2 ,4 ,3 ,2 ,3 ,3 ,3 ,4 ,2 ,2 ,4 ,2 ,3 ,3 ,4 ,2 ,3 ,3 ,4 ,4 ,2 ,3 ,2 ,3 ,2 ,2 ,3 ,2 ,4 ,2 ,2 ,4 ,3 ,2 ,4 ,4 ,4 ,4 ,2 ,3 ,4 ,2 ,2 ,2 ,2 ,3 ,3};
    vector<vector<string>> list(m);
    number net = 0;

    for(int i = 0; i < m; i++)
    {
        for(int j = 0; j < n; j++)
        {
            int chars = size[j];
            list[i].emplace_back("");
            vector<char> buf(chars+1);
            cin.read(buf.data(), chars);
            buf[chars] = '\0';
            string number(buf.data());
            list[i][j] = number;
            
            // to read the space between columns
            char buf1[2];
            cin.read(buf1, 1);
            string s(buf1, 1);
        }
    }

    vector<char> operations(n);
    for(int i = 0; i < n; i++)
    {
        cin >> operations[i];
    }
    
    for(int i = 0; i < n; i++)
    {
        vector<number> operands(size[i]);
        int el = -1;
        for(int j = i; j < m*n; j += n)
        {
            el++;
            for(int k = 0; k < size[i]; k++)
            {
                if(list[el][i][k] == ' ') continue;
                else
                {
                    operands[k] *= 10;
                    operands[k] += list[el][i][k] - 48;
                }
            }
        }
        if(operations[i] == '*')
        {
            number ans = 1;
            for (int k = 0; k < size[i]; k++)
            {
                ans *= operands[k];
            }
            net += ans;
        }
        else
        {
            number ans = 0;
            for (int k = 0; k < size[i]; k++)
            {
                ans += operands[k];
            }
            net += ans;
        }

    }

    cout << net;

}
